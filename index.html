<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RHADZOR Calendar PRO v3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --premium-gradient: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            --gold-gradient: linear-gradient(135deg, #d97706 0%, #fbbf24 100%);
            --romance-gradient: linear-gradient(135deg, #be185d 0%, #ec4899 100%);
            --accent-blue: #3b82f6;
            --bg-slate: #f1f5f9;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #e2e8f0;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            height: 100dvh;
            overflow: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .app-container {
            width: 100%;
            max-width: 448px;
            background: #f8fafc;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        /* Header Layout Updated */
        .header-rhadzor {
            background: var(--premium-gradient);
            padding: 0 1rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 20;
            height: 70px;
        }

        .header-left, .header-right {
            width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-center {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .nav-row-compact {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .month-year-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            font-size: 1.1rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            white-space: nowrap;
        }

        .nav-arrow {
            padding: 0.5rem;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
            font-size: 0.9rem;
        }
        .nav-arrow:hover { opacity: 1; }

        .btn-today-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-today-icon:hover { background: rgba(255,255,255,0.25); }

        .btn-setting {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
            cursor: pointer;
            font-size: 1.1rem;
            transition: opacity 0.2s;
        }
        .btn-setting:hover { opacity: 1; }

        .hijri-label {
            font-size: 0.6rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            opacity: 0.6;
            margin-top: 0.1rem;
            color: #cbd5e1;
        }

        /* Floating Search Button */
        .btn-floating-search {
            position: absolute;
            bottom: 5rem;
            right: 1.5rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            cursor: move;
            z-index: 30;
            transition: background 0.2s, transform 0.1s;
            border: 1px solid rgba(255,255,255,0.2);
            touch-action: none;
        }
        
        .btn-floating-search:active { 
            background: rgba(15, 23, 42, 0.6); 
            transform: scale(0.95);
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            padding-bottom: 5rem;
            scrollbar-width: none;
        }
        .main-content::-webkit-scrollbar { display: none; }

        /* Calendar Body */
        .calendar-card {
            background: #f8fafc;
            border-radius: 24px;
            box-shadow: 8px 8px 16px #cbd5e1, -8px -8px 16px #ffffff;
            padding: 1rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
            touch-action: pan-y pinch-zoom;
        }

        .calendar-grid-container {
            width: 100%;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .day-label {
            text-align: center;
            font-size: 0.7rem;
            font-weight: 800;
            color: #64748b;
            padding-bottom: 0.75rem;
            text-transform: uppercase;
        }

        .day-cell {
            aspect-ratio: 1/1.1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
            color: #1e293b;
            border: 1px solid transparent;
        }
        
        .day-cell:active { transform: scale(0.95); }

        .day-cell.today {
            background: var(--premium-gradient);
            color: white !important;
            box-shadow: 0 8px 16px rgba(30, 27, 75, 0.25);
            transform: scale(1.02);
            z-index: 2;
            border: none;
        }

        /* Styling Ulang Tahun & Anniversary */
        .day-cell.birthday {
            background: var(--gold-gradient);
            color: white !important;
            box-shadow: 0 4px 12px rgba(217, 119, 6, 0.4);
            border: 2px solid white;
            z-index: 3;
        }
        .day-cell.birthday .hijri-text, .day-cell.birthday .pasaran-text { opacity: 0.9; }

        .day-cell.anniversary {
            background: var(--romance-gradient);
            color: white !important;
            box-shadow: 0 4px 12px rgba(190, 24, 93, 0.4);
            border: 2px solid white;
            z-index: 3;
        }
        .day-cell.anniversary .hijri-text, .day-cell.anniversary .pasaran-text { opacity: 0.9; }

        /* DOT INDICATORS */
        .date-wrapper {
            position: relative;
            display: inline-block;
            line-height: 1;
        }

        .cuti-dot {
            position: absolute;
            bottom: 2px;
            right: -6px;
            width: 5px;
            height: 5px;
            background-color: #ef4444; /* Red */
            border-radius: 50%;
            z-index: 10;
        }

        .obs-dot {
            position: absolute;
            bottom: 2px;
            left: -6px;
            width: 5px;
            height: 5px;
            background-color: #3b82f6; /* Blue */
            border-radius: 50%;
            z-index: 10;
        }
        
        /* Adjust layout */
        .day-cell .pasaran-text {
            font-size: 0.5rem;
            font-weight: 500;
            opacity: 0.6;
            margin-top: 4px;
        }

        .day-cell.highlight-animate {
            animation: highlightPulse 1s ease-out;
            background: #3b82f6 !important;
            color: white !important;
        }
        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            50% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }

        .day-cell.sunday, .day-cell.holiday { color: #ef4444; }
        .day-cell.friday { color: #059669; }

        .hidden-element { display: none !important; }

        .hijri-text {
            font-size: 0.5rem;
            position: absolute;
            top: 4px;
            right: 5px; 
            left: auto;
            opacity: 0.5;
            font-weight: 400;
        }

        /* List Items - UNIFIED STYLE */
        .holiday-item {
            padding: 0.85rem 1rem;
            background: #ffffff;
            border-radius: 16px;
            border-left: 4px solid #ef4444;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            margin-bottom: 0.5rem;
        }

        .observance-item {
            padding: 0.85rem 1rem;
            background: #ffffff;
            border-radius: 16px;
            border-left: 4px solid #3b82f6; /* Blue Border */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            margin-bottom: 0.5rem;
        }
        
        .birthday-item {
            padding: 0.85rem 1rem;
            background: #fffbeb;
            border-radius: 16px;
            border-left: 4px solid #d97706;
            box-shadow: 0 4px 6px -1px rgba(217, 119, 6, 0.1);
            margin-bottom: 0.5rem;
        }

        .anniversary-item {
            padding: 0.85rem 1rem;
            background: #fdf2f8;
            border-radius: 16px;
            border-left: 4px solid #be185d;
            box-shadow: 0 4px 6px -1px rgba(190, 24, 93, 0.1);
            margin-bottom: 0.5rem;
        }

        .quote-minimalist {
            margin-top: 2.5rem;
            text-align: center;
            padding: 0 1.5rem;
        }

        .quote-text {
            font-size: 0.9rem;
            color: #64748b;
            font-style: italic;
            line-height: 1.6;
            font-weight: 400;
        }

        /* Footer */
        .footer-rhadzor {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(5px);
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            border-top: 1px solid #e2e8f0;
            gap: 0.75rem;
            z-index: 10;
        }

        .rhadzor-logo {
            width: 28px;
            height: 28px;
            background: var(--premium-gradient);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 900;
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
            display: none;
            justify-content: center;
            align-items: flex-end;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .modal-overlay.active { 
            display: flex; 
            opacity: 1;
        }

        .modal-content {
            background: white;
            width: 100%;
            max-width: 448px;
            border-top-left-radius: 28px;
            border-top-right-radius: 28px;
            padding: 1.5rem;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }

        .modal-overlay.active .modal-content { transform: translateY(0); }

        /* Scroller Styles */
        .scroller-wrapper {
            position: relative;
            height: 220px;
            overflow: hidden;
            mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
            -webkit-mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
            margin: 1rem 0;
            display: flex;
        }

        .scroller-col {
            flex: 1;
            height: 100%;
            overflow-y: auto;
            scroll-behavior: smooth;
            padding: 85px 0;
            scrollbar-width: none;
            text-align: center;
            scroll-snap-type: y mandatory;
        }
        .scroller-col::-webkit-scrollbar { display: none; }

        .scroller-item {
            padding: 10px;
            font-size: 1.1rem;
            font-weight: 500;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.5;
            scroll-snap-align: center;
        }

        .scroller-item.active {
            font-size: 1.5rem;
            font-weight: 800;
            color: #0f172a;
            transform: scale(1.1);
            opacity: 1;
        }

        .selection-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            height: 50px;
            border-top: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
            pointer-events: none;
            z-index: -1;
            background: #f8fafc;
        }

        .modal-header-line {
            width: 48px;
            height: 6px;
            background: #e2e8f0;
            border-radius: 99px;
            margin: 0 auto 1.5rem auto;
        }
        
        .toggle-switch {
            appearance: none;
            width: 44px;
            height: 24px;
            background: #cbd5e1;
            border-radius: 99px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s;
        }
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .toggle-switch:checked { background: #3b82f6; }
        .toggle-switch:checked::after { transform: translateX(20px); }
    </style>
</head>
<body>

<div class="app-container">
    <header class="header-rhadzor">
        <!-- Kiri: Tombol Setting -->
        <div class="header-left">
            <div class="btn-setting" onclick="openSettings()">
                <i class="fas fa-cog"></i>
            </div>
        </div>

        <!-- Tengah: Navigasi Bulan/Tahun -->
        <div class="header-center">
            <div class="nav-row-compact">
                <div class="nav-arrow" onclick="changeMonth(-1)">
                    <i class="fas fa-chevron-left"></i>
                </div>
                
                <div class="month-year-title">
                    <span class="unit-wrapper" id="monthLabel" onclick="openMonthSelector()">JANUARI</span>
                    <span class="unit-wrapper" id="yearLabel" onclick="openYearSelector()">2026</span>
                </div>

                <div class="nav-arrow" onclick="changeMonth(1)">
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            <div class="hijri-label" id="hijriRange">RAJAB - SYA'BAN</div>
        </div>
        
        <!-- Kanan: Tombol Hari Ini -->
        <div class="header-right">
            <div class="btn-today-icon" onclick="goToToday()">
                <i class="fas fa-calendar-day text-sm"></i>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="calendar-card" id="swipeArea">
            <div class="calendar-grid-container" id="gridContainer">
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>
        </div>

        <!-- Holidays & Birthdays List -->
        <div class="space-y-2" id="holidayContainer"></div>

        <!-- Minimalist Quote -->
        <div class="quote-minimalist">
            <p class="quote-text" id="quoteDisplay"></p>
        </div>
    </main>

    <!-- Floating Search Button -->
    <div id="searchBtn" class="btn-floating-search" onclick="handleSearchClick()">
        <i class="fas fa-search"></i>
    </div>

    <footer class="footer-rhadzor">
        <div class="rhadzor-logo">R</div>
        <span class="text-xs font-black tracking-[0.2em] text-slate-800 uppercase">RHADZOR</span>
    </footer>
</div>

<!-- Modal -->
<div class="modal-overlay" id="selectorModal" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header-line"></div>
        <h3 id="modalTitle" class="text-center font-bold text-slate-800 mb-2 uppercase text-xs tracking-widest hidden">JUDUL MODAL</h3>
        
        <!-- Container for dynamic content -->
        <div id="modalBodyWrapper" class="flex-1 overflow-hidden flex flex-col">
            <div id="modalBody" class="w-full"></div>
        </div>
    </div>
</div>

<script>
    const quotes = [
        "Semakin kita mencari kebahagiaan, semakin jauh ia menghilang.", "Kegagalan terbesar adalah tidak pernah mencoba.", "Kata-kata terlembut bisa melukai paling dalam.", "Kita belajar paling banyak dari orang yang paling kita benci.", "Diam terkadang lebih berisik daripada teriakan.", "Kehilangan mengajarkan kita nilai memiliki.", "Kesendirian ramai, keramaian bisa sangat sunyi.", "Menerima adalah cara terkuat untuk melawan.", "Kita paling kuat saat mengakui kelemahan.", "Berubah adalah satu-satunya yang tetap.", "Makin banyak tahu, makin sadar tak tahu apa-apa.", "Waktu sembuhkan luka, waktu juga ciptakan luka.", "Cinta membebaskan dengan cara mengikat.", "Kesederhanaan butuh usaha yang rumit.", "Memberi adalah cara terbaik menerima.", "Memaafkan membebaskan yang memaafkan.", "Ketakutan terbesar adalah takut itu sendiri.", "Kontrol dimulai dari melepas kontrol.", "Kematian memberi arti pada kehidupan.", "Harapan bisa menjadi belenggu tersendiri.", "Kebenaran menyakitkan lebih baik dari kebohongan manis.", "Kesalahan masa lalu adalah guru terbaik hari ini.", "Semakin keras kita pegang, semakin mudah lepas.", "Pertanyaan lebih berharga daripada jawaban.", "Kegelapan mengajarkan kita menghargai cahaya.", "Kepastian adalah ilusi yang nyaman.", "Kita paling hidup saat hampir mati.", "Mendengar lebih sulit daripada berbicara.", "Kesuksesan dimulai dari kegagalan berulang.", "Kehilangan jalan adalah cara menemukan jalan baru.", "Keraguan adalah awal dari kebijaksanaan.", "Melambat terkadang cara tercepat sampai tujuan.", "Rasa sakit mengingatkan kita bahwa kita hidup.", "Mengenal diri sendiri adalah perjalanan seumur hidup.", "Kebahagiaan sejati datang dari dalam, bukan luar.", "Waktu tidak bisa dibeli tapi sering kita sia-siakan.", "Masalah terbesar sering punya solusi tersederhana.", "Kehilangan adalah bagian dari memiliki.", "Kesempurnaan adalah musuh dari kemajuan.", "Kita tumbuh paling cepat di luar zona nyaman.", "Yang kita takuti sering tidak pernah terjadi.", "Kebencian meracuni yang membenci.", "Berhenti adalah langkah maju terkadang.", "Mimpi tanpa aksi hanya angan-angan.", "Ketenangan lahir dari menerima kekacauan.", "Perpisahan mengajarkan arti kebersamaan.", "Kekuatan sejati adalah kelembutan.", "Hidup dimulai di ujung zona nyaman.", "Kesabaran adalah kekuatan yang tersembunyi.", "Melepas adalah bentuk kepemilikan tertinggi."
    ];

    // --- DATA ULANG TAHUN KELUARGA ---
    const familyBirthdays = [
        { name: "Rhadzor", day: 28, month: 5, year: 1986 }, // Month 5 is June
        { name: "Lisa Istri Tercinta ❤️❤️", day: 22, month: 6, year: 1988 }, // Month 6 is July
        { name: "Alby", day: 3, month: 8, year: 2013 }, // Month 8 is Sept
        { name: "Meka", day: 2, month: 3, year: 2020 }, // Month 3 is April
        { name: "Sansa", day: 21, month: 3, year: 2022 } // Month 3 is April
    ];

    const weddingAnniversary = { day: 23, month: 11, year: 2012 }; // Month 11 is Dec

    // --- DATA HARI LIBUR NASIONAL (Template Tahunan) ---
    // Struktur: Year -> Month (0-11) -> Day -> Name
    const holidaysData = {
        2025: {
            0: { 1: "Tahun Baru 2025 Masehi", 27: "Isra Mikraj Nabi Muhammad SAW", 29: "Tahun Baru Imlek 2576 Kongzili" },
            2: { 29: "Hari Suci Nyepi (Tahun Baru Saka 1947)", 31: "Idul Fitri 1446 Hijriah" },
            3: { 1: "Idul Fitri 1446 Hijriah", 18: "Wafat Yesus Kristus", 20: "Kebangkitan Yesus Kristus (Paskah)" },
            4: { 1: "Hari Buruh Internasional", 12: "Hari Raya Waisak 2569 BE", 29: "Kenaikan Yesus Kristus" },
            5: { 1: "Hari Lahir Pancasila", 6: "Idul Adha 1446 Hijriah", 27: "1 Muharam Tahun Baru Islam 1447 Hijriah" },
            7: { 17: "Proklamasi Kemerdekaan RI" },
            8: { 5: "Maulid Nabi Muhammad SAW" },
            11: { 25: "Kelahiran Yesus Kristus (Natal)" }
        },
        2026: {
            0: { 1: "Tahun Baru 2026 Masehi", 16: "Isra Mikraj Nabi Muhammad SAW" },
            1: { 17: "Tahun Baru Imlek 2577 Kongzili" },
            2: { 19: "Hari Suci Nyepi (Tahun Baru Saka 1948)", 21: "Idul Fitri 1447 Hijriah", 22: "Idul Fitri 1447 Hijriah" },
            3: { 3: "Wafat Yesus Kristus", 5: "Kebangkitan Yesus Kristus (Paskah)" },
            4: { 1: "Hari Buruh Internasional", 14: "Kenaikan Yesus Kristus", 27: "Idul Adha 1447 Hijriah", 31: "Hari Raya Waisak 2570 BE" },
            5: { 1: "Hari Lahir Pancasila", 16: "1 Muharam Tahun Baru Islam 1448 Hijriah" },
            7: { 17: "Proklamasi Kemerdekaan RI", 25: "Maulid Nabi Muhammad SAW" },
            11: { 25: "Kelahiran Yesus Kristus (Natal)" }
        }
    };

    // --- DATA CUTI BERSAMA (Template Tahunan) ---
    // Struktur: Year -> Month (0-11) -> Day -> Name
    const cutiBersamaData = {
        2025: {
            0: { 28: "Cuti Bersama Imlek 2576" },
            2: { 28: "Cuti Bersama Nyepi Saka 1947" },
            3: { 2: "Cuti Bersama Idul Fitri", 3: "Cuti Bersama Idul Fitri", 4: "Cuti Bersama Idul Fitri", 7: "Cuti Bersama Idul Fitri" },
            4: { 13: "Cuti Bersama Waisak", 30: "Cuti Bersama Kenaikan Yesus Kristus" },
            5: { 9: "Cuti Bersama Idul Adha" },
            7: { 18: "Cuti Bersama Proklamasi Kemerdekaan" },
            11: { 26: "Cuti Bersama Natal" }
        },
        2026: {
            1: { 16: "Cuti Bersama Imlek 2577" },
            2: { 18: "Cuti Bersama Nyepi Saka 1948", 20: "Cuti Bersama Idul Fitri", 23: "Cuti Bersama Idul Fitri", 24: "Cuti Bersama Idul Fitri" },
            4: { 15: "Cuti Bersama Kenaikan Yesus Kristus", 28: "Cuti Bersama Idul Adha" },
            11: { 24: "Cuti Bersama Natal" }
        }
    };

    // --- DATA HARI PERINGATAN NASIONAL (FIX) ---
    // Month (0-11) -> Day -> Name
    const nationalObservances = {
        0: {
            3: "Hari Amal Bhakti Kemenag RI",
            5: "Hari Korps Wanita Angkatan Laut (KOWAL)",
            10: "Hari Gerakan Satu Juta Pohon / Hari Tritura",
            15: "Hari Dharma Samudera",
            17: "Hari Raya Siwaratri",
            23: "Hari Patriotik",
            25: "Hari Gizi Nasional",
            31: "Hari Lahir Nahdlatul Ulama (NU)"
        },
        1: {
            5: "Hari Peristiwa Kapal Tujuh",
            9: "Hari Pers Nasional (HPN)",
            14: "Peringatan Pembela Tanah Air (PETA)",
            21: "Hari Peduli Sampah Nasional",
            28: "Hari Gizi Nasional Indonesia"
        },
        2: {
            1: "Peristiwa Serangan Umum 1 Maret",
            9: "Hari Musik Nasional",
            30: "Hari Film Nasional"
        },
        3: {
            6: "Hari Nelayan Indonesia",
            9: "Hari TNI Angkatan Udara",
            16: "Hari Komando Pasukan Khusus (Kopassus)",
            21: "Hari Kartini",
            27: "Hari Pemasyarakatan Indonesia",
            28: "Hari Puisi Nasional"
        },
        4: {
            2: "Hari Pendidikan Nasional (Hardiknas)",
            17: "Hari Buku Nasional",
            20: "Hari Kebangkitan Nasional",
            29: "Hari Lanjut Usia Nasional"
        },
        5: {
            21: "Hari Krida Pertanian",
            24: "Hari Bidan Nasional",
            29: "Hari Keluarga Berencana (KB)"
        },
        6: {
            1: "Hari Bhayangkara",
            5: "Hari Bank Indonesia",
            12: "Hari Koperasi Indonesia",
            22: "Hari Kejaksaan",
            23: "Hari Anak Nasional"
        },
        7: {
            5: "Hari Dharma Wanita Nasional",
            10: "Hari Veteran Nasional",
            14: "Hari Pramuka",
            21: "Hari Maritim Nasional",
            24: "Hari Televisi Nasional (TVRI)"
        },
        8: {
            1: "Hari Polisi Wanita (Polwan)",
            3: "Hari Palang Merah Indonesia (PMI)",
            4: "Hari Pelanggan Nasional",
            9: "Hari Olahraga Nasional",
            17: "Hari Perhubungan Nasional",
            24: "Hari Tani Nasional",
            28: "Hari Kereta Api",
            30: "Peringatan G30S/PKI"
        },
        9: {
            1: "Hari Kesaktian Pancasila",
            2: "Hari Batik Nasional",
            5: "Hari Tentara Nasional Indonesia (TNI)",
            24: "Hari Dokter Indonesia",
            27: "Hari Listrik Nasional",
            28: "Hari Sumpah Pemuda",
            30: "Hari Keuangan Nasional"
        },
        10: {
            5: "Hari Cinta Puspa dan Satwa Nasional",
            10: "Hari Pahlawan",
            12: "Hari Kesehatan Nasional / Hari Ayah Nasional",
            14: "Hari Brigade Mobil (Brimob)",
            25: "Hari Guru (HUT PGRI)",
            28: "Hari Menanam Pohon Indonesia",
            29: "Hari KORPRI"
        },
        11: {
            12: "Hari Transmigrasi",
            13: "Hari Nusantara",
            19: "Hari Bela Negara",
            22: "Hari Ibu"
        }
    };

    const hijriMonths = ["MUHARRAM", "SAFAR", "RABIUL AWAL", "RABIUL AKHIR", "JUMADIL AWAL", "JUMADIL AKHIR", "RAJAB", "SYA'BAN", "RAMADHAN", "SYAWAL", "DZULQA'DAH", "DZULHIJJAH"];
    const pasaranArr = ["LEGI", "PAHING", "PON", "WAGE", "KLIWON"];
    const monthNames = ["JANUARI", "FEBRUARI", "MARET", "APRIL", "MEI", "JUNI", "JULI", "AGUSTUS", "SEPTEMBER", "OKTOBER", "NOVEMBER", "DESEMBER"];
    const dayNames = ["MINGGU", "SENIN", "SELASA", "RABU", "KAMIS", "JUMAT", "SABTU"];
    const dayShortNames = ["MGG", "SEN", "SEL", "RAB", "KAM", "JUM", "SAB"];

    let currentDate = new Date();
    let isAnimating = false;
    let isDragging = false;
    
    // SETTINGS STATE
    let settings = {
        showHijri: true,
        showPasaran: true,
        showObservances: true,
        showFamily: true
    };

    function init() {
        renderCalendar();
        updateQuote();
        setupSwipe();
        setupDrag();
    }

    // --- DRAG LOGIC FOR SEARCH BUTTON ---
    function setupDrag() {
        const btn = document.getElementById('searchBtn');
        let offsetX, offsetY;

        btn.addEventListener('touchstart', (e) => {
            isDragging = false;
            const touch = e.touches[0];
            const rect = btn.getBoundingClientRect();
            offsetX = touch.clientX - rect.left;
            offsetY = touch.clientY - rect.top;
        }, {passive: false});

        btn.addEventListener('touchmove', (e) => {
            isDragging = true;
            e.preventDefault();
            const touch = e.touches[0];
            const x = touch.clientX - offsetX;
            const y = touch.clientY - offsetY;
            const maxX = window.innerWidth - btn.offsetWidth;
            const maxY = window.innerHeight - btn.offsetHeight;
            btn.style.left = `${Math.min(Math.max(0, x), maxX)}px`;
            btn.style.top = `${Math.min(Math.max(0, y), maxY)}px`;
            btn.style.bottom = 'auto';
            btn.style.right = 'auto';
        }, {passive: false});
        
        btn.addEventListener('mousedown', (e) => {
            isDragging = false;
            const rect = btn.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            function onMouseMove(e) {
                isDragging = true;
                const x = e.clientX - offsetX;
                const y = e.clientY - offsetY;
                btn.style.left = `${x}px`;
                btn.style.top = `${y}px`;
                btn.style.bottom = 'auto';
                btn.style.right = 'auto';
            }
            function onMouseUp() {
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            }
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        });
    }

    function handleSearchClick() {
        if (!isDragging) openDateSearch();
    }

    function getHolidayName(d, m, y) {
        if (holidaysData[y] && holidaysData[y][m] && holidaysData[y][m][d]) return holidaysData[y][m][d];
        return null;
    }

    function getCutiBersamaName(d, m, y) {
        if (cutiBersamaData[y] && cutiBersamaData[y][m] && cutiBersamaData[y][m][d]) return cutiBersamaData[y][m][d];
        return null;
    }

    function getObservanceName(d, m) {
        if (settings.showObservances && nationalObservances[m] && nationalObservances[m][d]) return nationalObservances[m][d];
        return null;
    }

    function getBirthday(d, m) {
        if (!settings.showFamily) return null;
        return familyBirthdays.find(b => b.day === d && b.month === m);
    }
    
    function isAnniversary(d, m) {
        if (!settings.showFamily) return null;
        return weddingAnniversary.day === d && weddingAnniversary.month === m;
    }

    function renderCalendar() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        
        document.getElementById('monthLabel').textContent = monthNames[month];
        document.getElementById('yearLabel').textContent = year;
        
        const hijriIdx1 = (month + 6) % 12; 
        const hijriIdx2 = (month + 7) % 12;
        const hijriLabelEl = document.getElementById('hijriRange');
        hijriLabelEl.textContent = `${hijriMonths[hijriIdx1]} - ${hijriMonths[hijriIdx2]}`;
        hijriLabelEl.style.display = settings.showHijri ? 'block' : 'none';

        const grid = document.getElementById('calendarGrid');
        grid.innerHTML = '';
        
        dayShortNames.forEach(d => {
            const el = document.createElement('div');
            el.className = 'day-label';
            el.textContent = d;
            grid.appendChild(el);
        });
        
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        
        for (let i = 0; i < firstDay; i++) {
            grid.appendChild(document.createElement('div'));
        }
        
        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(year, month, d);
            const todayDate = new Date();
            const isToday = d === todayDate.getDate() && month === todayDate.getMonth() && year === todayDate.getFullYear();
            
            const dayOfWeek = dateObj.getDay();
            const isSunday = dayOfWeek === 0;
            const isFriday = dayOfWeek === 5;
            
            const holidayName = getHolidayName(d, month, year);
            const isHoliday = !!holidayName;
            
            const cutiName = getCutiBersamaName(d, month, year);
            const isCuti = !!cutiName;

            const observanceName = getObservanceName(d, month);
            const isObservance = !!observanceName;

            const birthdayData = getBirthday(d, month);
            const isBirthday = !!birthdayData;
            
            const anniversaryData = isAnniversary(d, month);
            
            // Logic Pasaran & Hijri
            const refDate = new Date(2026, 0, 1);
            const diff = Math.floor((dateObj - refDate) / 86400000);
            const pasaranIdx = (3 + (diff % 5) + 5) % 5;
            const hijriDateNum = ((d + 12) % 30) + 1;
            
            let hMonthIdx = hijriIdx1;
            if (hijriDateNum < 15) hMonthIdx = hijriIdx1;
            
            const cell = document.createElement('div');
            
            let cellClass = `day-cell ${isToday ? 'today' : ''}`;
            if (anniversaryData) cellClass += ' anniversary';
            else if (isBirthday) cellClass += ' birthday';
            else if (isSunday || isHoliday) cellClass += ' sunday';
            else if (isFriday) cellClass += ' friday';
            
            cell.className = cellClass;
            cell.id = isToday ? 'currentDayCell' : '';

            const hijriClass = settings.showHijri ? 'hijri-text' : 'hijri-text hidden-element';
            const pasaranClass = settings.showPasaran ? 'pasaran-text' : 'pasaran-text hidden-element';
            
            // Dots
            const cutiDotHTML = isCuti ? `<div class="cuti-dot"></div>` : '';
            const obsDotHTML = isObservance ? `<div class="obs-dot"></div>` : '';

            cell.innerHTML = `
                <span class="${hijriClass}">${hijriDateNum}</span>
                <span class="date-wrapper">${d}${cutiDotHTML}${obsDotHTML}</span>
                <span class="${pasaranClass}">${pasaranArr[pasaranIdx]}</span>
            `;
            
            cell.onclick = () => showDetail(
                d, 
                month, 
                year, 
                dayNames[dayOfWeek],
                pasaranArr[pasaranIdx], 
                hijriDateNum, 
                hijriMonths[hMonthIdx],
                holidayName,
                cutiName,
                observanceName,
                isSunday,
                birthdayData,
                anniversaryData
            );
            grid.appendChild(cell);
        }
        renderEventsList(month, year);
    }

    function renderEventsList(month, year) {
        const container = document.getElementById('holidayContainer');
        container.innerHTML = '';
        
        // 0. Render Anniversary
        if (settings.showFamily && weddingAnniversary.month === month) {
            const annAge = year - weddingAnniversary.year;
            if (annAge > 0) {
                 const div = document.createElement('div');
                div.className = 'anniversary-item flex justify-between items-center';
                div.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-[0.7rem] font-bold text-pink-800">${weddingAnniversary.day} ${monthNames[month]}</span>
                        <span class="text-[0.6rem] text-pink-600 font-semibold">Anniversary Pernikahan ❤️</span>
                    </div>
                    <span class="text-[0.65rem] font-bold text-pink-700 bg-pink-100 px-2 py-1 rounded-full">Ke-${annAge}</span>
                `;
                container.appendChild(div);
            }
        }

        // 1. Render Birthdays
        if (settings.showFamily) {
            const monthBirthdays = familyBirthdays.filter(b => b.month === month).sort((a,b) => a.day - b.day);
            monthBirthdays.forEach(b => {
                const age = year - b.year;
                const div = document.createElement('div');
                div.className = 'birthday-item flex justify-between items-center';
                div.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-[0.7rem] font-bold text-amber-800">${b.day} ${monthNames[month]}</span>
                        <span class="text-[0.6rem] text-amber-600 font-semibold" style="max-width: 150px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">Ulang Tahun ${b.name}</span>
                    </div>
                    <span class="text-[0.65rem] font-bold text-amber-700 bg-amber-100 px-2 py-1 rounded-full">Ke-${age}</span>
                `;
                container.appendChild(div);
            });
        }

        // 2. Render Holidays & Cuti Bersama & Observances (Merged & Sorted)
        let mergedEvents = [];

        // Collect Holidays
        if (holidaysData[year] && holidaysData[year][month]) {
            Object.keys(holidaysData[year][month]).forEach(d => {
                mergedEvents.push({ day: parseInt(d), name: holidaysData[year][month][d], type: 'holiday' });
            });
        }

        // Collect Cuti Bersama
        if (cutiBersamaData[year] && cutiBersamaData[year][month]) {
            Object.keys(cutiBersamaData[year][month]).forEach(d => {
                mergedEvents.push({ day: parseInt(d), name: cutiBersamaData[year][month][d], type: 'cuti' });
            });
        }

        // Collect Observances
        if (settings.showObservances && nationalObservances[month]) {
            Object.keys(nationalObservances[month]).forEach(d => {
                mergedEvents.push({ day: parseInt(d), name: nationalObservances[month][d], type: 'observance' });
            });
        }

        // Sort by Date
        mergedEvents.sort((a, b) => a.day - b.day);

        mergedEvents.forEach(evt => {
            const div = document.createElement('div');
            // Distinguish styling
            if(evt.type === 'observance') {
                div.className = 'observance-item flex justify-between items-center';
                div.innerHTML = `
                    <span class="text-[0.7rem] font-bold text-slate-800">${evt.day} ${monthNames[month]}</span>
                    <span class="text-[0.65rem] text-blue-600 font-medium text-right" style="max-width: 65%;">${evt.name}</span>
                `;
            } else {
                // Holiday & Cuti share style
                div.className = 'holiday-item flex justify-between items-center';
                div.innerHTML = `
                    <span class="text-[0.7rem] font-bold text-slate-800">${evt.day} ${monthNames[month]}</span>
                    <span class="text-[0.65rem] text-red-600 font-medium text-right" style="max-width: 65%;">${evt.name}</span>
                `;
            }
            container.appendChild(div);
        });
    }

    function goToToday() {
        currentDate = new Date();
        renderCalendar();
        setTimeout(() => {
            const todayCell = document.getElementById('currentDayCell');
            if (todayCell) {
                todayCell.classList.add('highlight-animate');
                setTimeout(() => todayCell.classList.remove('highlight-animate'), 1000);
            }
        }, 100);
    }

    function updateQuote() {
        const idx = Math.floor(Math.random() * quotes.length);
        document.getElementById('quoteDisplay').textContent = `"${quotes[idx]}"`;
    }

    function changeMonth(dir) {
        if (isAnimating) return;
        isAnimating = true;
        const container = document.getElementById('gridContainer');
        container.style.opacity = '0';
        container.style.transform = dir > 0 ? 'translateX(-15%)' : 'translateX(15%)';
        setTimeout(() => {
            currentDate.setMonth(currentDate.getMonth() + dir);
            renderCalendar();
            updateQuote();
            container.style.transition = 'none';
            container.style.transform = dir > 0 ? 'translateX(15%)' : 'translateX(-15%)';
            setTimeout(() => {
                container.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s';
                container.style.transform = 'translateX(0)';
                container.style.opacity = '1';
                setTimeout(() => isAnimating = false, 400);
            }, 20);
        }, 200);
    }

    // --- SETTINGS ---
    function openSettings() {
        const body = document.getElementById('modalBody');
        const title = document.getElementById('modalTitle');
        title.classList.remove('hidden');
        title.textContent = "PENGATURAN";
        body.className = "p-4 space-y-4";
        body.innerHTML = `
            <div class="flex justify-between items-center p-2 bg-slate-50 rounded-xl">
                <span class="font-bold text-sm text-slate-700">Tampilkan Tanggal Jawa</span>
                <input type="checkbox" class="toggle-switch" ${settings.showPasaran ? 'checked' : ''} onchange="toggleSetting('showPasaran')">
            </div>
            <div class="flex justify-between items-center p-2 bg-slate-50 rounded-xl">
                <span class="font-bold text-sm text-slate-700">Tampilkan Tanggal Hijriah</span>
                <input type="checkbox" class="toggle-switch" ${settings.showHijri ? 'checked' : ''} onchange="toggleSetting('showHijri')">
            </div>
            <div class="flex justify-between items-center p-2 bg-slate-50 rounded-xl">
                <span class="font-bold text-sm text-slate-700">Tampilkan Hari Peringatan</span>
                <input type="checkbox" class="toggle-switch" ${settings.showObservances ? 'checked' : ''} onchange="toggleSetting('showObservances')">
            </div>
            <div class="flex justify-between items-center p-2 bg-slate-50 rounded-xl">
                <span class="font-bold text-sm text-slate-700">Tampilkan Hari Keluarga</span>
                <input type="checkbox" class="toggle-switch" ${settings.showFamily ? 'checked' : ''} onchange="toggleSetting('showFamily')">
            </div>
        `;
        openModal();
    }

    function toggleSetting(key) {
        settings[key] = !settings[key];
        renderCalendar(); 
    }

    // --- SCROLLER LOGIC ---
    function createScrollerItem(text, value, isActive) {
        const item = document.createElement('div');
        item.className = `scroller-item ${isActive ? 'active' : ''}`;
        item.textContent = text;
        item.dataset.value = value;
        return item;
    }
    
    function setupScrollSnapObserver(containerId) {
        const container = document.getElementById(containerId);
        let scrollTimeout;
        container.onscroll = () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const center = container.scrollTop + (container.clientHeight / 2);
                const items = container.querySelectorAll('.scroller-item');
                let closest = null;
                let minDiff = Infinity;
                items.forEach(item => {
                    const itemCenter = item.offsetTop + (item.offsetHeight / 2);
                    const diff = Math.abs(center - itemCenter);
                    if (diff < minDiff) { minDiff = diff; closest = item; }
                    item.classList.remove('active');
                });
                if (closest) closest.classList.add('active');
            }, 50);
        };
    }

    // Month Selector
    function openMonthSelector() {
        const body = document.getElementById('modalBody');
        const title = document.getElementById('modalTitle');
        title.classList.remove('hidden');
        title.textContent = "PILIH BULAN";
        body.className = "grid grid-cols-3 gap-3 p-2";
        body.innerHTML = '';
        monthNames.forEach((m, i) => {
            const div = document.createElement('div');
            div.className = `p-3 text-center rounded-xl font-bold text-[0.75rem] cursor-pointer transition ${currentDate.getMonth() === i ? 'bg-slate-900 text-white shadow-lg' : 'bg-slate-50 text-slate-600 hover:bg-slate-100'}`;
            div.textContent = m;
            div.onclick = () => { currentDate.setMonth(i); renderCalendar(); closeModal(); };
            body.appendChild(div);
        });
        openModal();
    }

    // Year Selector
    function openYearSelector() {
        const body = document.getElementById('modalBody');
        const title = document.getElementById('modalTitle');
        title.classList.remove('hidden');
        title.textContent = "PILIH TAHUN";
        body.className = "w-full";
        const currentYear = currentDate.getFullYear();
        body.innerHTML = `
            <div class="scroller-wrapper">
                <div class="selection-indicator"></div>
                <div class="scroller-col" id="yearListScroll"></div>
            </div>
            <button onclick="selectHighlightedYear()" class="w-full mt-4 bg-slate-900 text-white p-3 rounded-xl font-bold text-xs tracking-wider">PILIH TAHUN INI</button>
        `;
        const list = document.getElementById('yearListScroll');
        for(let y = currentYear - 100; y <= currentYear + 100; y++) {
            list.appendChild(createScrollerItem(y, y, y === currentYear));
        }
        openModal();
        setupScrollSnapObserver('yearListScroll');
        setTimeout(() => {
            const active = list.querySelector('.active');
            if(active) active.scrollIntoView({ block: 'center' });
        }, 100);
    }

    function selectHighlightedYear() {
        const activeEl = document.querySelector('#yearListScroll .active');
        if(activeEl) {
            currentDate.setFullYear(parseInt(activeEl.dataset.value));
            renderCalendar();
            closeModal();
        }
    }

    // Date Search
    function openDateSearch() {
        const body = document.getElementById('modalBody');
        const title = document.getElementById('modalTitle');
        title.classList.remove('hidden');
        title.textContent = "CARI BULAN & TAHUN";
        body.className = "w-full";
        const curM = currentDate.getMonth();
        const curY = currentDate.getFullYear();
        body.innerHTML = `
            <div class="scroller-wrapper">
                <div class="selection-indicator"></div>
                <div class="scroller-col" id="monthScroller"></div>
                <div class="scroller-col" id="yearScroller"></div>
            </div>
            <button onclick="jumpToSelectedMonthYear()" class="w-full mt-4 bg-slate-900 text-white p-3 rounded-xl font-bold text-xs tracking-wider">LIHAT KALENDER</button>
        `;
        const mList = document.getElementById('monthScroller');
        const yList = document.getElementById('yearScroller');
        monthNames.forEach((m, i) => { mList.appendChild(createScrollerItem(m, i, i === curM)); });
        for(let y = curY - 50; y <= curY + 50; y++) { yList.appendChild(createScrollerItem(y, y, y === curY)); }
        openModal();
        setupScrollSnapObserver('monthScroller');
        setupScrollSnapObserver('yearScroller');
        setTimeout(() => {
            const activeM = mList.querySelector('.active');
            const activeY = yList.querySelector('.active');
            if(activeM) activeM.scrollIntoView({ block: 'center' });
            if(activeY) activeY.scrollIntoView({ block: 'center' });
        }, 100);
    }

    function jumpToSelectedMonthYear() {
        const activeM = document.querySelector('#monthScroller .active');
        const activeY = document.querySelector('#yearScroller .active');
        if(activeM && activeY) {
            currentDate.setMonth(parseInt(activeM.dataset.value));
            currentDate.setFullYear(parseInt(activeY.dataset.value));
            renderCalendar();
            updateQuote();
            closeModal();
        }
    }

    // DETAIL HARI
    function showDetail(d, m, y, dayName, pasaranName, hDate, hMonth, holiday, cutiName, observanceName, isSunday, birthdayData, anniversaryData) {
        const body = document.getElementById('modalBody');
        const title = document.getElementById('modalTitle');
        title.classList.add('hidden');
        body.className = "p-4 text-center";
        
        const detailQuote = quotes[Math.floor(Math.random() * quotes.length)];
        const isRedDay = isSunday || !!holiday;
        
        let dateColor = isRedDay ? "text-red-600" : "text-slate-900";
        let subColor = isRedDay ? "text-red-400" : "text-slate-400";
        
        if(birthdayData) {
            dateColor = "text-amber-600";
            subColor = "text-amber-400";
        } else if (anniversaryData) {
            dateColor = "text-pink-600";
            subColor = "text-pink-400";
        }

        let specialBadge = '';
        if (holiday) {
            specialBadge += `<div class="mt-2 px-3 py-1 bg-red-100 text-red-600 rounded-full font-bold text-[0.65rem] uppercase tracking-wide border border-red-200 inline-block mx-1 mb-1">${holiday}</div>`;
        }
        if (cutiName) {
            specialBadge += `<div class="mt-2 px-3 py-1 bg-red-50 text-red-500 rounded-full font-bold text-[0.65rem] uppercase tracking-wide border border-red-200 inline-block mx-1 mb-1">${cutiName}</div>`;
        }
        if (observanceName) {
            specialBadge += `<div class="mt-2 px-3 py-1 bg-blue-50 text-blue-500 rounded-full font-bold text-[0.65rem] uppercase tracking-wide border border-blue-200 inline-block mx-1 mb-1">${observanceName}</div>`;
        }
        if (birthdayData) {
            const age = y - birthdayData.year;
            specialBadge += `<div class="mt-2 px-3 py-1 bg-amber-100 text-amber-700 rounded-full font-bold text-[0.65rem] uppercase tracking-wide border border-amber-200 inline-block mx-1 mb-1">🎉 ULTAH ${birthdayData.name} KE-${age}</div>`;
        }
        if (anniversaryData) {
            const annAge = y - weddingAnniversary.year;
             specialBadge += `<div class="mt-2 px-3 py-1 bg-pink-100 text-pink-700 rounded-full font-bold text-[0.65rem] uppercase tracking-wide border border-pink-200 inline-block mx-1 mb-1">💍 ANNIVERSARY KE-${annAge}</div>`;
        }

        const pasaranText = settings.showPasaran ? pasaranName : '';
        const hijriTextDisplay = settings.showHijri ? `${hDate} ${hMonth} 1447H` : '';

        body.innerHTML = `
            <div class="flex flex-col items-center justify-center mb-6">
                <div class="text-6xl font-black ${dateColor} leading-none tracking-tighter transition-colors">${d}</div>
                <div class="text-xs font-bold ${subColor} uppercase mt-1 tracking-widest mb-1 transition-colors">${monthNames[m]} ${y}</div>
                 ${specialBadge}
            </div>

            <div class="bg-white border border-slate-100 rounded-3xl p-4 shadow-sm mb-5">
                <div class="text-xl font-black text-slate-800 uppercase tracking-tight">${dayName} ${pasaranText}</div>
                <div class="text-sm font-medium text-slate-500 mt-1">${hijriTextDisplay}</div> 
            </div>

            <div class="p-5 bg-slate-50 rounded-3xl border border-slate-100 mb-4">
                <i class="fas fa-quote-left text-slate-300 text-xl mb-2 block text-center"></i>
                <p class="text-sm italic text-slate-600 leading-relaxed font-medium text-center">"${detailQuote}"</p>
            </div>
        `;
        openModal();
    }

    function openModal() {
        document.getElementById('selectorModal').classList.add('active');
    }

    function closeModal() {
        document.getElementById('selectorModal').classList.remove('active');
    }

    function setupSwipe() {
        let startX = 0;
        const area = document.getElementById('swipeArea');
        area.addEventListener('touchstart', e => { startX = e.changedTouches[0].screenX; }, {passive: false});
        area.addEventListener('touchend', e => { 
            const endX = e.changedTouches[0].screenX;
            if (endX < startX - 60) changeMonth(1);
            if (endX > startX + 60) changeMonth(-1);
        }, {passive: false});
    }

    window.onload = init;
</script>
</body>
</html>
